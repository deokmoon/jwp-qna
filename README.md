# 우아한테크캠프 PRO - JPA 미션
<pre>
작성자: 강덕문 / https://github.com/deokmoon / deok2moon@gmail.com
작성시작일: 2022.11.07
</pre>

## Step1 엔티티 매핑 요구사항 정리
* 아래의 DDL(Data Definition Language)을 보고 유추하여 엔티티 클래스와 리포지토리 클래스를 작성
* @DataJpaTest를 사용하여 학습 테스트
### Answer Entity
~~~~sql
create table answer
(
    id          bigint generated by default as identity,
    contents    clob,
    created_at  timestamp not null,
    deleted     boolean   not null,
    question_id bigint,
    updated_at  timestamp,
    writer_id   bigint,
    primary key (id)
)
~~~~
### DeleteHistory Entity
~~~~sql
create table delete_history
(
    id            bigint generated by default as identity,
    content_id    bigint,
    content_type  varchar(255),
    create_date   timestamp,
    deleted_by_id bigint,
    primary key (id)
)
~~~~
### Question Entity
~~~~sql
create table question
(
    id         bigint generated by default as identity,
    contents   clob,
    created_at timestamp    not null,
    deleted    boolean      not null,
    title      varchar(100) not null,
    updated_at timestamp,
    writer_id  bigint,
    primary key (id)
)
~~~~
### User Entity
~~~~sql
create table user
(
    id         bigint generated by default as identity,
    created_at timestamp   not null,
    email      varchar(50),
    name       varchar(20) not null,
    password   varchar(20) not null,
    updated_at timestamp,
    user_id    varchar(20) not null,
    primary key (id)
)

alter table user
    add constraint UK_a3imlf41l37utmxiquukk8ajc unique (user_id)
~~~~

### 적용한 yml 내용
~~~~yml
spring:
  datasource:
    url: jdbc:h2:~/test;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
    username: sa
    driver-class-name: org.h2.Driver
  h2:
    console:
      enabled: true
  jpa:
    hibernate:
      ddl-auto: create-drop
    properties:
      hibernate:
        show_sql: true
        format_sql: true

logging.level:
  org.hibernate.SQL: debug
  org.hibernate.type: trace
~~~~
* Mysql 형식으로 설정
* H2 콘솔 설정 진행
* ddl-auto를 create으로 설정
  * 테스트 환경으로 로그 확인하기 위함 
  * application 실행 시 기존 테이블 삭제되고 생성 로그 확인
* BaseDateEntity 적용
  * 공통적인 created_at / updated_at 처리
* domain / repository 패키지 부리
* Test 
  * repository: 조회 저장 삭제 위주의 테스트코드 작성
